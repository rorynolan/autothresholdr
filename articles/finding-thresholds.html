<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Finding Thresholds • autothresholdr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Finding Thresholds">
<meta property="og:description" content="autothresholdr">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">autothresholdr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.11</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/finding-thresholds.html">Finding Thresholds</a>
    </li>
    <li>
      <a href="../articles/thresholding-image-stacks.html">Thresholding Image Stacks</a>
    </li>
    <li>
      <a href="../articles/thresholding-images.html">Thresholding Images</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rorynolan/autothresholdr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="finding-thresholds_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Finding Thresholds</h1>
            
            <h4 class="date">2021-05-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/rorynolan/autothresholdr/blob/master/vignettes/finding-thresholds.Rmd"><code>vignettes/finding-thresholds.Rmd</code></a></small>
      <div class="hidden name"><code>finding-thresholds.Rmd</code></div>

    </div>

    
    
<p>Most of the examples from this package are centred around thresholding images, but really the core function <code><a href="../reference/auto_thresh.html">auto_thresh()</a></code> can be used to find thresholds for any non-negative integer data.</p>
<div id="mostly-high-some-low" class="section level2">
<h2 class="hasAnchor">
<a href="#mostly-high-some-low" class="anchor"></a>Mostly high, some low</h2>
<p>Let’s create a vector of values, most of which are greater than 50, the rest of which are less than 10:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample.int</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">2e5</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">51</span><span class="op">:</span><span class="fl">99</span>, <span class="fl">8e5</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Now let’s take a look at the distribution of <code>x</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">stat_density</a></span><span class="op">(</span>bw <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<p><img src="finding-thresholds_files/figure-html/plot-high-low-1.png" width="672"></p>
<p>If you’re trying to threshold this sort of data, you’re probably looking for a method which will find a threshold that separates the larger values from the smaller ones. The available automatic thresholding methods are “IJDefault”, “Huang”, “Huang2”, “Intermodes”, “IsoData”, “Li”, “MaxEntropy”, “Mean”, “MinErrorI”, “Minimum”, “Moments”, “Otsu”, “Percentile”, “RenyiEntropy”, “Shanbhag”, “Triangle” and “Yen”. These are well demonstrated at <a href="https://imagej.net/Auto_Threshold" class="uri">https://imagej.net/Auto_Threshold</a>.</p>
</div>
<div id="trying-all-methods" class="section level2">
<h2 class="hasAnchor">
<a href="#trying-all-methods" class="anchor"></a>Trying all methods</h2>
<p>“MaxEntropy” and “Yen” often fail to find a threshold, so I generally avoid them. Let’s try out all the rest.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rorynolan.github.io/autothresholdr/">autothresholdr</a></span><span class="op">)</span>
<span class="va">thresh_methods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="st">"IJDefault"</span>, <span class="st">"Huang"</span>, <span class="st">"Huang2"</span>, <span class="st">"Intermodes"</span>, <span class="st">"IsoData"</span>,
  <span class="st">"Li"</span>, <span class="st">"Mean"</span>, <span class="st">"MinErrorI"</span>, <span class="st">"Minimum"</span>, <span class="st">"Moments"</span>, <span class="st">"Otsu"</span>,
  <span class="st">"Percentile"</span>, <span class="st">"RenyiEntropy"</span>, <span class="st">"Shanbhag"</span>, <span class="st">"Triangle"</span>
<span class="op">)</span>
<span class="va">thresholds</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_chr</a></span><span class="op">(</span><span class="va">thresh_methods</span>, <span class="op">~</span> <span class="fu"><a href="../reference/auto_thresh.html">auto_thresh</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">.</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>method <span class="op">=</span> <span class="va">thresh_methods</span>, threshold <span class="op">=</span> <span class="va">.</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">thresholds</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 15 x 2</span>
<span class="co">#&gt;    method       threshold</span>
<span class="co">#&gt;    &lt;chr&gt;        &lt;chr&gt;    </span>
<span class="co">#&gt;  1 IJDefault    40       </span>
<span class="co">#&gt;  2 Huang        9        </span>
<span class="co">#&gt;  3 Huang2       9        </span>
<span class="co">#&gt;  4 Intermodes   39       </span>
<span class="co">#&gt;  5 IsoData      40       </span>
<span class="co">#&gt;  6 Li           25       </span>
<span class="co">#&gt;  7 Mean         60       </span>
<span class="co">#&gt;  8 MinErrorI    60       </span>
<span class="co">#&gt;  9 Minimum      33       </span>
<span class="co">#&gt; 10 Moments      56       </span>
<span class="co">#&gt; 11 Otsu         9        </span>
<span class="co">#&gt; 12 Percentile   68       </span>
<span class="co">#&gt; 13 RenyiEntropy 70       </span>
<span class="co">#&gt; 14 Shanbhag     70       </span>
<span class="co">#&gt; 15 Triangle     11</span></code></pre></div>
<p>Now, which of these selected a threshold between 10 and 49?</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">thresholds</span>, <span class="va">threshold</span> <span class="op">&gt;=</span> <span class="fl">10</span>, <span class="va">threshold</span> <span class="op">&lt;=</span> <span class="fl">49</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 x 2</span>
<span class="co">#&gt;   method     threshold</span>
<span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;    </span>
<span class="co">#&gt; 1 IJDefault  40       </span>
<span class="co">#&gt; 2 Intermodes 39       </span>
<span class="co">#&gt; 3 IsoData    40       </span>
<span class="co">#&gt; 4 Li         25       </span>
<span class="co">#&gt; 5 Minimum    33       </span>
<span class="co">#&gt; 6 Triangle   11</span></code></pre></div>
<p>The other methods aren’t necessarily <em>wrong</em>, they’re just more strict or more lax than these ones. For thresholding microscopy images to remove background, my favourite methods are “Huang” and “Triangle” because they are quite conservative in that anything even slightly above background is kept.</p>
</div>
<div id="using-one-method" class="section level2">
<h2 class="hasAnchor">
<a href="#using-one-method" class="anchor"></a>Using one method</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/auto_thresh.html">auto_thresh</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"huang"</span><span class="op">)</span>
<span class="co">#&gt; [1] 9</span>
<span class="co">#&gt; attr(,"ignore_black")</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; attr(,"ignore_white")</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; attr(,"ignore_na")</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; attr(,"autothresh_method")</span>
<span class="co">#&gt; [1] "Huang"</span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "th"      "integer"</span>
<span class="fu"><a href="../reference/auto_thresh.html">auto_thresh</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"tri"</span><span class="op">)</span>
<span class="co">#&gt; [1] 11</span>
<span class="co">#&gt; attr(,"ignore_black")</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; attr(,"ignore_white")</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; attr(,"ignore_na")</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; attr(,"autothresh_method")</span>
<span class="co">#&gt; [1] "Triangle"</span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "th"      "integer"</span>
<span class="fu"><a href="../reference/auto_thresh.html">auto_thresh</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"otsu"</span><span class="op">)</span>
<span class="co">#&gt; [1] 9</span>
<span class="co">#&gt; attr(,"ignore_black")</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; attr(,"ignore_white")</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; attr(,"ignore_na")</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; attr(,"autothresh_method")</span>
<span class="co">#&gt; [1] "Otsu"</span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "th"      "integer"</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Rory Nolan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
